<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MeSH | Vertical Expandable Tree</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            scroll-behavior: smooth;
        }

        body {
            font-family: Arial, sans-serif;
        }

        .mesh-wrapper {
            padding: 50px 30px;
            max-width: 800px;
            margin: 0 auto;
        }

        .mesh-item {
            padding: 1rem;
            border: solid 1px #ccc;
            display: none; /* Initially hide all items */
            margin-bottom: 30px;
        }

        .mesh-tag {
            cursor: pointer;
            color: black;
            background-color: #efefef;
            padding: 5px 10px;
            display: none; /* Hide category tags initially */
            margin: 0 5px 5px 0;
        }

        .category-search {
            margin-top: 20px;
        }

        .tree {
            list-style-type: none;
            padding-left: 20px;
            position: relative;
        }

        .tree li {
            cursor: pointer;
            margin: 5px 0;
            position: relative;
        }

        .nested {
            list-style-type: none;
            padding-left: 20px;
            display: block;
        }

        .toggle-icon {
            margin-left: 5px;
            font-weight: bold;
            cursor: pointer;
        }

        .search-box {
            margin: 15px 0 30px 0;
            padding: 5px;
            width: 100%;
        }

        .search-results div {
            cursor: pointer;
            padding: 5px;
            background-color: #efefef;
            margin: 5px 0;
        }

        .category-tags {
            margin-bottom: 30px;
        }
        hr {
            border: none;
            height: 1px;
            background-color: #ccc;
            margin: 15px 0;
        }
    </style>
</head>

<body>

    <div class="mesh-wrapper">
        <p style="background-color: yellow; padding: 10px;"><strong>Demo instructions:</strong> Enter the term "breast cancer" or "palliative care" into the search field, then select the tag.</p>
        <br>
        <h2>Categories</h2>

        <input type="text" id="categorySearch" class="search-box" placeholder="Search categories...">
        <div id="searchResults" class="search-results"></div>

        <div id="categoryTags" class="category-tags">
            <div class="mesh-tag" data-category="breast-cancer">Breast Cancer (Breast Neoplasms) <i class="fa-solid fa-xmark"></i></div>
            <div class="mesh-tag" data-category="palliative-care">Palliative Care <i class="fa-solid fa-xmark"></i></div>
        </div>

        <div id="items">
            <div class="mesh-item" data-category="breast-cancer">
                <h4>Breast Cancer</h4>
                <hr>
                <ul class="tree">
                    <li onclick="toggle(event, this)"><input type="checkbox"> Diseases [C] <span class="toggle-icon">➖</span>
                        <ul class="nested">
                            <li onclick="toggle(event, this)"><input type="checkbox"> Neoplasms [C04] <span class="toggle-icon">➖</span>
                                <ul class="nested">
                                    <li onclick="toggle(event, this)"><input type="checkbox"> Neoplasms by Site [C04.588] <span class="toggle-icon">➖</span>
                                        <ul class="nested">
                                            <li onclick="toggle(event, this)"><input type="checkbox" checked> Breast Neoplasms [C04.588.180] <span class="toggle-icon">➖</span></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
<hr>

<ul class="tree">
    <li onclick="toggle(event, this)"><input type="checkbox"> Diseases [C] <span class="toggle-icon">➖</span>
        <ul class="nested">
            <li onclick="toggle(event, this)"><input type="checkbox"> Skin and Connective Tissue Diseases [C17] <span class="toggle-icon">➖</span>
                <ul class="nested">
                    <li onclick="toggle(event, this)"><input type="checkbox"> Skin Diseases [C17.800] <span class="toggle-icon">➖</span>
                        <ul class="nested">
                            <li onclick="toggle(event, this)"><input type="checkbox"> Breast Diseases [C17.800.090] <span class="toggle-icon">➖</span></li>

                                    <ul class="nested">
                                        <li onclick="toggle(event, this)"><input type="checkbox" checked> Breast Neoplasms [C17.800.090.500]  <span class="toggle-icon">➖</span></li>
                                    </ul>

                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </li>
</ul>


            </div>

            <div class="mesh-item" data-category="palliative-care">
                <h4>Palliative Care</h4>
                <hr>
                <ul class="tree">
                    <li onclick="toggle(event, this)"><input type="checkbox"> Health Care [N] <span class="toggle-icon">➖</span>
                        <ul class="nested">
                            <li onclick="toggle(event, this)"><input type="checkbox"> Health Care Facilities, Manpower, and Services [N02]​ <span class="toggle-icon">➖</span>
                                <ul class="nested">
                                    <li onclick="toggle(event, this)"><input type="checkbox"> Health Services [N02.421] <span class="toggle-icon">➖</span>
                                        <ul class="nested">
                                            <li onclick="toggle(event, this)"><input type="checkbox"> Patient Care [N02.421.585] <span class="toggle-icon">➖</span></li>

                                            <ul class="nested">
                                                <li onclick="toggle(event, this)"><input type="checkbox" checked> Palliative Care [N02.421.585.666] <span class="toggle-icon">➖</span></li>
                                            </ul>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <hr>

                <ul class="tree">
                    <li onclick="toggle(event, this)"><input type="checkbox"> Analytical, Diagnostic and Therapeutic Techniques and Equipment [E] <span class="toggle-icon">➖</span>
                        <ul class="nested">
                            <li onclick="toggle(event, this)"><input type="checkbox"> Therapeutics [E02] <span class="toggle-icon">➖</span>
                                <ul class="nested">
                                    <li onclick="toggle(event, this)"><input type="checkbox"> Patient Care [E02.760] <span class="toggle-icon">➖</span>
                                        <ul class="nested">
                                            <li onclick="toggle(event, this)"><input type="checkbox" checked> Palliative Care [E02.760.666] <span class="toggle-icon">➖</span></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <script>

let selectedIndex = -1; // Keeps track of the currently selected search result

const categorySearch = document.getElementById("categorySearch");
const searchResults = document.getElementById("searchResults");

categorySearch.addEventListener("keydown", function (event) {
    let results = searchResults.querySelectorAll("div");
    if (event.key === "ArrowDown") {
        event.preventDefault();
        selectedIndex = (selectedIndex + 1) % results.length;
        updateSelection(results);
    } else if (event.key === "ArrowUp") {
        event.preventDefault();
        selectedIndex = (selectedIndex - 1 + results.length) % results.length;
        updateSelection(results);
    } else if (event.key === "Enter") {
        event.preventDefault();
        if (selectedIndex >= 0 && results[selectedIndex]) {
            results[selectedIndex].click();
        } else {
            performSearch();
        }
    }
});

categorySearch.addEventListener("input", function () {
    performSearch();
});

function performSearch() {
    searchResults.innerHTML = "";
    selectedIndex = -1; // Reset selection
    let searchTerm = categorySearch.value.toLowerCase();

    let categories = [
        { name: "Breast Cancer (Breast Neoplasms)", id: "breast-cancer" },
        { name: "Palliative Care", id: "palliative-care" }
    ];

    let filtered = categories.filter(cat => cat.name.toLowerCase().includes(searchTerm));

    if (searchTerm === "") {
        document.querySelectorAll(".mesh-item").forEach(item => item.style.display = "none");
        document.querySelectorAll(".mesh-tag").forEach(tag => tag.style.display = "none");
        return;
    }

    filtered.forEach((cat, index) => {
        let result = document.createElement("div");
        result.textContent = cat.name;
        result.setAttribute("data-category", cat.id);
        result.addEventListener("click", function () {
            showCategory(cat.id);
        });
        searchResults.appendChild(result);
    });
}

function updateSelection(results) {
    results.forEach((result, index) => {
        result.style.backgroundColor = index === selectedIndex ? "#ddd" : "#efefef";
    });
}

function showCategory(category) {
    document.querySelector(`.mesh-item[data-category='${category}']`).style.display = "block";
    document.querySelector(`.mesh-tag[data-category='${category}']`).style.display = "inline-block";
    searchResults.innerHTML = "";
    categorySearch.value = "";
}

document.querySelectorAll(".mesh-tag").forEach(tag => {
    tag.addEventListener("click", function () {
        let category = this.getAttribute("data-category");
        document.querySelector(`.mesh-item[data-category='${category}']`).style.display = "none";
        this.style.display = "none";
    });
});



    </script>
</body>
</html>